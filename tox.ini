[tox]
envlist = py310,py311,py312,lint,type

[testenv]
description = Exécuter les tests unitaires
deps = 
    pytest>=7.4.3
    pytest-cov>=4.1.0
    hypothesis>=6.88.0
commands = 
    pytest {posargs:tests/}

[testenv:lint]
description = Vérifier la qualité du code avec flake8
deps = 
    flake8>=6.1.0
    flake8-docstrings
    black>=23.12.0
    isort>=5.13.2
commands = 
    flake8 transaction_api tests
    black --check transaction_api tests
    isort --check-only transaction_api tests

[testenv:format]
description = Formater le code avec black et isort
deps = 
    black>=23.12.0
    isort>=5.13.2
commands = 
    black transaction_api tests
    isort transaction_api tests

[testenv:type]
description = Vérifier les types avec mypy
deps = 
    mypy>=1.7.1
    types-requests
commands = 
    mypy transaction_api

[testenv:coverage]
description = Générer un rapport de couverture de code
deps = 
    pytest>=7.4.3
    pytest-cov>=4.1.0
    hypothesis>=6.88.0
commands = 
    pytest --cov=transaction_api --cov-report=html --cov-report=term-missing tests/

[flake8]
max-line-length = 88
exclude = .git,__pycache__,.venv,build,dist,.tox
ignore = E203,W503,D100,D104

[pytest]
testpaths = tests
python_files = test_*.py *_test.py
addopts = --cov=transaction_api --cov-report=term-missing
